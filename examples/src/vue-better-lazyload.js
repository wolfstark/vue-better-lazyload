!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define("vue-better-lazyload",["vue"],t):"object"==typeof exports?exports["vue-better-lazyload"]=t(require("vue")):e["vue-better-lazyload"]=t(e.Vue)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(t,n){t.exports=e},function(e,t,n){"use strict";(function(e){function r(t,n){void 0===n&&(n={}),n.name=n.name||t._componentTag||t.name;var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(e){if("constructor"!==e)if(c.indexOf(e)>-1)n[e]=r[e];else{var t=Object.getOwnPropertyDescriptor(r,e);"function"==typeof t.value?(n.methods||(n.methods={}))[e]=t.value:(t.get||t.set)&&((n.computed||(n.computed={}))[e]={get:t.get,set:t.set})}}),(n.mixins||(n.mixins=[])).push({data:function(){return function(t,n){var r=n.prototype._init;n.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var r in t.$options.props)t.hasOwnProperty(r)||n.push(r);n.forEach(function(n){"_"!==n.charAt(0)&&Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e},configurable:!0})})};var o=new n;n.prototype._init=r;var u={};return Object.keys(o).forEach(function(e){void 0!==o[e]&&(u[e]=o[e])}),"production"!==e.env.NODE_ENV&&!(n.prototype instanceof i)&&Object.keys(u).length,u}(this,t)}});var o=t.__decorators__;o&&(o.forEach(function(e){return e(n)}),delete t.__decorators__);var f=Object.getPrototypeOf(t.prototype),s=f instanceof i?f.constructor:i,l=s.extend(n);return function(t,n,r){Object.getOwnPropertyNames(n).forEach(function(o){if("prototype"!==o){var i=Object.getOwnPropertyDescriptor(t,o);if(!i||i.configurable){var c=Object.getOwnPropertyDescriptor(n,o);if(!u){if("cid"===o)return;var f=Object.getOwnPropertyDescriptor(r,o);if(!function(e){var t=typeof e;return null==e||"object"!==t&&"function"!==t}(c.value)&&f&&f.value===c.value)return}"production"!==e.env.NODE_ENV&&a.indexOf(o)>=0&&n.name,Object.defineProperty(t,o,c)}}})}(l,t,s),l}function o(e){return"function"==typeof e?r(e):function(t){return r(t,e)}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n(0)),u={__proto__:[]}instanceof Array,c=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured"],a=["cid","super","options","superOptions","extendOptions","sealedOptions","component","directive","filter"];!function(e){(o||(o={})).registerHooks=function(e){c.push.apply(c,e)}}();var f=o;t.default=f,t.createDecorator=function(e){return function(t,n,r){var o="function"==typeof t?t:t.constructor;o.__decorators__||(o.__decorators__=[]),"number"!=typeof r&&(r=void 0),o.__decorators__.push(function(t){return e(t,n,r)})}}}).call(t,n(5))},function(e,t,n){"use strict";function r(e){return e.container.$el===window?function(e){var t=e.$el.getBoundingClientRect(),n=window.innerHeight,r=window.innerWidth;return o(Object.assign({},t,{containerHeight:n,containerWidth:r}))}(e):function(e){var t=e.$el.getBoundingClientRect(),n=e.container.$el.getBoundingClientRect(),r=n.height,i=n.width,u=t.top-n.top,c=t.left-n.left,a=t.height,f=t.width;return o({top:u,left:c,height:a,width:f,containerHeight:r,containerWidth:i})}(e)}function o(e){var t=e.top,n=e.left,r=e.height,o=e.width,i=e.containerHeight,u=e.containerWidth;return t<i&&t+r>0&&n<u&&n+o>0}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var c,a=n(3),f=n.n(a),s=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,!1)}catch(e){}return e}()&&{capture:!1,passive:!0},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=Object.create(null),this.retry=t}return l(e,[{key:"load",value:function(e){var t=this;return this.mountCache(e),new Promise(function(n,r){t.cache[e].loaded?n():t.preloadImage(e,n,r)})}},{key:"preloadImage",value:function(e,t,n){var r=this;if(this.isOverLimit(e))n();else{var o=new Image;o.src=e,this.cache[e].retry+=1,o.onload=function(){r.cache[e].loaded=!0,t()},o.onerror=function(){r.preloadImage(e,t,n)}}}},{key:"isOverLimit",value:function(e){return this.cache[e].retry>=this.retry}},{key:"mountCache",value:function(e){this.cache[e]||(this.cache[e]={loaded:!1,retry:0})}}]),e}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listenerQueue=[],this.containerQueue=[],this.eventList=["scroll","wheel","resize","animationend","transitionend","touchmove"],e.instance)return e.instance;e.instance=this,this.options=t,this.lazyLoadHandler=f()(this.lazyLoadHandler,t.wait),this.imageLoader=new p(t.retry)}return d(e,[{key:"addListener",value:function(e){this.listenerQueue.push(e)}},{key:"addContainer",value:function(e){this.containerQueue.some(function(t){return t.$el===e.$el})?e.listenerCount+=1:(this.bindListenerHandle(e.$el),this.containerQueue.push(e))}},{key:"removeListener",value:function(e){var t=this.listenerQueue.indexOf(e);-1!==t&&this.listenerQueue.splice(t,1),this.removeContainer(e),e=null}},{key:"removeContainer",value:function(e){var t=this.containerQueue.indexOf(e.container),n=this.containerQueue[t];-1!==t&&(n.listenerCount-=1,0===n.listenerCount&&(this.removeListenerHandle(n.$el),this.containerQueue.splice(t,1)))}},{key:"bindListenerHandle",value:function(e){var t=this;this.eventList.forEach(function(n){return function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3],e.addEventListener(t,n,s)}(e,n,t.lazyLoadHandler.bind(t))})}},{key:"removeListenerHandle",value:function(e){var t=this;this.eventList.forEach(function(n){return function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3],e.removeEventListener(t,n,!1)}(e,n,t.lazyLoadHandler.bind(t))})}},{key:"lazyLoadHandler",value:function(){this.listenerQueue.forEach(function(e){!e.lock&&r(e)&&e.load()})}}]),e}(),y=n(0),v=n.n(y),b=n(1),m=n.n(b);!function(e){e[e.loading=0]="loading",e[e.loaded=1]="loaded",e[e.error=2]="error"}(c||(c={}));var g,w=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listenerCount=1,this.$el=t},O=function(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)},j=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,u=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(u=(i<3?o(u):i>3?o(t,n,u):o(t,n))||u);return i>3&&u&&Object.defineProperty(t,n,u),u},P=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=c.loading,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.a),j(t,[{key:"created",value:function(){this.core=new h}},{key:"mounted",value:function(){var e=this;this.container=new w(function(e){if(!(e instanceof HTMLElement))return window;for(var t=/(scroll|auto)/,n=e;n&&n!==document.body&&n!==document.documentElement&&n.parentNode;){var r=O(n,"overflow"),o=O(n,"overflow-x"),i=O(n,"overflow-y");if(t.test(r+o+i))return n;n=n.parentNode}return window}(this.$el)),this.core.addListener(this),this.core.addContainer(this.container),this.$nextTick(function(){r(e)&&e.load()})}},{key:"render",value:function(){switch(this.state){case c.loading:return this.getStateComponent(c.loading);case c.error:return this.getStateComponent(c.error);default:return this.$slots.default[0]}}},{key:"getStateComponent",value:function(e){var t=this.$createElement,n=this.core.options[e];return this.$slots[e]?this.$slots[e][0]:t(n,null,[])}},{key:"load",value:function(){var e=this;if(this.isImage()){var t=this.$slots.default[0].data.attrs.src;this.lock=!0,this.core.imageLoader.load(t).then(function(){e.state=c.loaded,e.core.removeListener(e)}).catch(function(){e.state=c.error,e.core.removeListener(e)})}else this.state=c.loaded}},{key:"isImage",value:function(){return"img"===this.$slots.default[0].tag}},{key:"beforeDestroy",value:function(){this.core.removeListener(this)}}]),t}(),L=P=E([m()({props:(g={height:String},i(g,c.loaded,Object),i(g,c.error,Object),g)})],P),T=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,u=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":A(Reflect))&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(u=(i<3?o(u):i>3?o(t,n,u):o(t,n))||u);return i>3&&u&&Object.defineProperty(t,n,u),u},k=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.a),T(t,[{key:"render",value:function(){return(0,arguments[0])("img",{attrs:{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"}},[])}}]),t}(),C=k=x([m.a],k),$={install:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.retry,o=n.wait,i=n.error,a=n.loading,f=(t={retry:r||3,wait:o||200},u(t,c.error,i||C),u(t,c.loading,a||C),t);new h(f),e.component("VLazyload",L)}};t.default=$},function(e,t,n){(function(t){function n(e,t,n){function u(t){var n=l,r=p;return l=p=void 0,w=t,h=e.apply(r,n)}function c(e){var n=e-v;return void 0===v||n>=t||n<0||j&&e-w>=d}function a(){var e=g();if(c(e))return f(e);y=setTimeout(a,function(e){var n=t-(e-v);return j?m(n,d-(e-w)):n}(e))}function f(e){return y=void 0,_&&l?u(e):(l=p=void 0,h)}function s(){var e=g(),n=c(e);if(l=arguments,p=this,v=e,n){if(void 0===y)return function(e){return w=e,y=setTimeout(a,t),O?u(e):h}(v);if(j)return y=setTimeout(a,t),u(v)}return void 0===y&&(y=setTimeout(a,t)),h}var l,p,d,h,y,v,w=0,O=!1,j=!1,_=!0;if("function"!=typeof e)throw new TypeError(i);return t=o(t)||0,r(n)&&(O=!!n.leading,d=(j="maxWait"in n)?b(o(n.maxWait)||0,t):d,_="trailing"in n?!!n.trailing:_),s.cancel=function(){void 0!==y&&clearTimeout(y),w=0,l=v=p=y=void 0},s.flush=function(){return void 0===y?h:f(g())},s}function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&v.call(e)==c}(e))return u;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=s.test(e);return n||l.test(e)?p(e.slice(2),n?2:8):f.test(e)?u:+e}var i="Expected a function",u=NaN,c="[object Symbol]",a=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,p=parseInt,d="object"==typeof t&&t&&t.Object===Object&&t,h="object"==typeof self&&self&&self.Object===Object&&self,y=d||h||Function("return this")(),v=Object.prototype.toString,b=Math.max,m=Math.min,g=function(){return y.Date.now()};e.exports=function(e,t,o){var u=!0,c=!0;if("function"!=typeof e)throw new TypeError(i);return r(o)&&(u="leading"in o?!!o.leading:u,c="trailing"in o?!!o.trailing:c),n(e,t,{leading:u,maxWait:t,trailing:c})}}).call(t,n(4))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(){h&&p&&(h=!1,p.length?d=p.concat(d):y=-1,d.length&&u())}function u(){if(!h){var e=o(i);h=!0;for(var t=d.length;t;){for(p=d,d=[];++y<t;)p&&p[y].run();y=-1,t=d.length}p=null,h=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===r||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function c(e,t){this.fun=e,this.array=t}function a(){}var f,s,l=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{s="function"==typeof clearTimeout?clearTimeout:r}catch(e){s=r}}();var p,d=[],h=!1,y=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new c(e,t)),1!==d.length||h||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=a,l.addListener=a,l.once=a,l.off=a,l.removeListener=a,l.removeAllListeners=a,l.emit=a,l.prependListener=a,l.prependOnceListener=a,l.listeners=function(e){return[]},l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}}])});
//# sourceMappingURL=vue-better-lazyload.js.map